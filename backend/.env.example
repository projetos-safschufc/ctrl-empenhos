# =============================================================================
# Backend – Controle de Empenhos e Estoque
# Copie para .env e preencha os valores. Senha com #, @ ou ! use entre aspas.
# =============================================================================

# --- Banco SAFS (aplicação principal, schema ctrl + public) ---
# Sem aspas, # é interpretado como comentário. Ex: DB_PASSWORD="abi123!@#qwe"
DB_HOST=10.28.0.159
DB_PORT=5432
DB_DATABASE=safs
DB_USER=abimael
DB_PASSWORD="sua_senha_aqui"

# Opcional: URL completa (senha codificada: ! → %21, @ → %40, # → %23)
# DATABASE_URL="postgresql://user:senha%23codificada@host:5432/safs"

# Pool/timeout (reduz ConnectionReset 10054 – conexão fechada pelo host remoto). Incluídos por padrão na URL.
# DB_CONNECTION_LIMIT=10
# DB_CONNECT_TIMEOUT=10
# DB_POOL_TIMEOUT=20

# --- JWT ---
JWT_SECRET=uma-chave-secreta-forte-aqui
# JWT_EXPIRES_IN=7d

# --- Banco DW (views: v_df_movimento, v_df_consumo_estoque, v_df_estoque, v_safs_fempenho) ---
# Se não informado, usa DB_* e DW_DATABASE=dw, DW_SCHEMA=public
# DW_HOST=10.28.0.159
# DW_PORT=5432
# DW_DATABASE=dw
# DW_USER=abimael
# DW_PASSWORD="sua_senha"
# DW_SCHEMA=public

# Schema do DW onde estão as views. Se aparecer "v_df_consumo_estoque does not exist", use gad_dlih_safs.
# DW_SCHEMA=gad_dlih_safs

# Colunas do DW (quando o nome na view difere do padrão)
# Provisionamento e consumo (v_df_consumo_estoque): coluna de material. Padrão codigo_padronizado; se a view usar cd_material (ex.: gad_dlih_safs), use DW_MATERIAL_COLUMN=cd_material
# DW_MATERIAL_COLUMN=codigo_padronizado
# Com DW_SCHEMA=gad_dlih_safs, a coluna qtde_a_receber é usada automaticamente para Saldo de empenhos.
# DW_USE_SPEC_COLUMNS=false
# Provisionamento: filtrar por registro_ativo = 'Sim' (view v_df_consumo_estoque)
# DW_REGISTRO_ATIVO_COLUMN=registro_ativo
# DW_USE_REGISTRO_ATIVO_COLUMN=false
# Consumo dos últimos 6 meses e mês atual (v_df_consumo_estoque). Padrão: z_6º_mes … z_1º_mes, consumo_mes_atual.
# DW_CONSUMO_Z6_COL=z_6º_mes
# DW_CONSUMO_Z5_COL=z_5º_mes
# DW_CONSUMO_Z4_COL=z_4º_mes
# DW_CONSUMO_Z3_COL=z_3º_mes
# DW_CONSUMO_Z2_COL=z_2º_mes
# DW_CONSUMO_Z1_COL=z_1º_mes
# DW_CONSUMO_MES_ATUAL_COL=consumo_mes_atual
# v_df_movimento (Mês último consumo / Qtde último consumo): coluna de material. Se a view usar cd_material (ex. gad_dlih_safs), use DW_MOV_MATERIAL_COLUMN=cd_material
# DW_MOV_MATERIAL_COLUMN=mat_cod_antigo
# v_safs_fempenho (Pré-empenho): com DW_SCHEMA=gad_dlih_safs usa cd_material por padrão.
# DW_FEMPNUM_COLUMN=numero_pre_empenho
# DW_FEMPNUM_MATERIAL_COLUMN=cd_material
# DW_FEMPNUM_REGISTRO_COLUMN=numero_do_registro
# DW_FEMPNUM_CODIGO_PRE_COLUMN=codigo_pre_empenho
# Se a coluna no DW tiver acento (ex.: código_pre_empenho), use: DW_FEMPNUM_CODIGO_PRE_COLUMN=código_pre_empenho

# Nº pré-empenho (Controle de Empenhos) – tabela public.empenho (banco da aplicação).
# Relação: empenho.cd_material = split_part(codigo_padronizado,'-',1), empenho.nu_registro_licitacao = numero_do_registro.
# Filtros: fl_evento='Empenho' (case-insensitive), nu_documento_siafi IS NULL, nu_registro_licitacao IS NOT NULL e <> '', status_pedido='Gerado' (case-insensitive).
# Padrão: cd_material, cd_empenho. Se a tabela usar outros nomes:
# EMPENHO_MATERIAL_COLUMN=material
# EMPENHO_NUMERO_PRE_COLUMN=numero

# --- Servidor ---
PORT=3001

# --- Ambiente (development | production) ---
# NODE_ENV=development
